# UsartPrint_example

基于stm32f10x系列单片机标准库的串口例程，打印各种东西，搭配上位机串口接收程序使用。终端里面还写了一个简单的数据包接收器

## 基本内容

* 发数字

* 发一个字节

* 发字符串

以上几个函数的声明和实现就在Usart.c和Usart.h文件中，一看就会，不多说了。

* 重定向的printf函数：可以选中某个串口，将printf的输出重定向到该串口。参数列表：第一个参数是串口号，第二个参数是printf的格式字符串，后面是任意数量的参数。格式化字符串别太长，到函数里面看一眼就知道了，接收的String变量只有100个char的大小。
对于c中的变参函数，参考<a href="https://blog.csdn.net/sinat_31039061/article/details/128338331">这篇文章</a>

* 中断函数中实现按一定格式接收并解析数据包：下面详述

## 关于数据包

自己设计的数据包的格式是：
* 起始字符：'['
* 结束字符：']'
* 分隔符：','

用法如下：
    [conmmand1:arg1 , command2:arg2 , command3:arg3 , ... ]
状态机解析数据包，把数据包截断成命令参数对，存在二维数组Rx_packet中。
因为定义的数组是10*20的，所以最多只能接收10个命令参数对，每个最长20个char。
接收好的命令参数对，可以传给相应的函数处理，命令也可以自定义。